<div class='blog-card container'>
  <div class='d-flex justify-content-between'>
    <div class='d-flex align-items-center'>
      <h2 class=''>
        <%= link_to post.title, author_post_path(post.author.id, post.id), class: 'fw-bolder' %>
      </h2>
      <% unless index_view %>
        <span>
          <%= link_to " by #{post.author.name}", author_posts_path, class: 'fs-3 align-items-center fw-bolder' %>
        </span>
      <% end %>
    </div>

    <div class='text-end d-flex flex-column justify-content-between align-items-center'>
      <% if current_user&.id == post.author_id %>
       <div class="">
          <div>
            <label for="delete-post-<%=post.id%>">
              <i class="fa-solid fa-trash cursor-pointer fs-5 text-danger justify-content-end" aria-hidden="true"></i>
            </label>
          </div>
          <div>
            <%= button_to '', post_path(post.id), method: :delete, class: 'd-none', id: "delete-post-#{post.id}" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <div class="d-flex align-items-center justify-content-between">
    <div><%= post.text %></div>

    <div class="align-items-evenly">
      <span class="fw-bolder"><%= t('comments')%> <%= post.comments_counter || 0 %></span><span class="fw-bolder"> | </span>
      <span class="fw-bolder"><%= t('likes')%> </span><%= render partial: 'posts/likes', locals: {post: post} %>
    </div>
  </div>
  
  <% if post.comments_counter.to_i > 0 and show_comment %>
    <div class="mt-3">
      <% if index_view %>
        <% post.comments_with_author_names.each { |comment_| %>
          <span><%= render partial: 'comment', object: comment_ %></span>
        <% } %>
      <% else %>
        <% post.comments_with_author_names(nil).each { |comment_| %>
          <%= render partial: 'comment', object: comment_ %>
        <% } %>
      <% end %>
    </div>
  <% end %>

</div>

<script>
  function send_like(id){
    console.log('hi', id)  
    fetch(`/posts/${id}/like`, {method: 'POST'})
      .then(res=>res.json())
      .then(res=>{
        const {post_likes_count} = res
        const el_likes_count = document.querySelector(`#likes_count_${id}`)
        el_likes_count.innerText = post_likes_count
  })
  }
</script>